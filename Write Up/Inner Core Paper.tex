\documentclass[11pt,a4paper]{article}
\usepackage{fullpage}	% Bigger pages
\usepackage{cite} 		% Include citations
\usepackage{hyperref} 	% Hyperlinks everywhere!
\usepackage{natbib}		% Include bibliography
\usepackage{graphicx}	% Include pictures
\usepackage{amsmath}	% Use \eqref

\begin{document}

\title{Constraining the Hemispherical Structure in the Hidden Layer At the Top of the Earth's Inner Core}
\author{Candidate Number: \\  \\ Supervisor: Prof. Keith Priestley}
\maketitle

\begin{abstract}
Since its discovery in 1936, the Earth's inner core has been well documented by both body wave and normal mode studies. However, one area where properties are not yet well measured is the top of the inner core. The upper region of the inner core is of particular interest as it is thought that as the outer core freezes onto the inner core the variable environment at this boundary is encoded in the properties of the frozen material. 
\end{abstract}

\tableofcontents

\newpage
\section{Introduction}
The inner core was first discovered by Inge Lehmann in 1936, who used the existence of P wave arrivals within the P wave shadow zone to infer a solid-liquid boundary lying within the core mantle boundary (\cite{Lehmann}). Over the following 80 years large progress has been made on measuring the properties of the inner core, but there is much still to learn.

Of particular interest is the velocity and attenuation structure, which can be used to infer the chemical and physical properties of the inner core's constituent material. The following gives a summary of these properties, and is quoted directly from \cite{Deuss2014}:
\begin{itemize}
	\item The top 60-80 km of the inner core is isotropic, and the deeper parts have 3-4\% anisotropy. The anisotropy exists in both velocity and attenuation; waves traveling in the polar direction are faster and more attenuated than waves traveling equatorially.
	\item There may be an innermost inner core with different anisotropy, though evidence is not compelling.\footnote{Research published since \cite{Deuss2014} provides strong evidence for this (\cite{Wang2015}).}
	\item The inner core displays a hemispherical variation: The western hemisphere is more strongly anisotropic, has a lower isotropic compressional velocity, and is less attenuating than the eastern hemisphere. There are sharp boundaries between the two hemispheres.
	\item Inner core superrotation is less than $0.5^{\circ}$ /yr and may even be as small as $0.1-1^{\circ}$ /Myr.
\end{itemize}

The upper inner core is of particular interest, as material from the outer core is currently freezing onto it at a rate of around 1mm/year (\cite{Labrosse2001}). Modelling performed by \cite{Deguen2009a} shows that the velocity structure of the upper inner core should reflect recent processes in the lower upper core. Thus measuring the structure of the upper inner core could in turn give insights into areas such as how the outer core generates the Earth's magnetic field. 

So far only large scale velocity structures have been measured, with the most recent velocity models BEING VERY COARSE GRAINED. In addition the extent to which the methodology used here and elsewhere is not well understood. In this paper we tackle both of these problems.

We do so by taking individual earthquakes that travel to multiple seismic stations and identifying the arrival of distant seismic phases in seismograms. We constrain our analysis to the uppermost inner core as far as is possible, and area not yet investigated in published literature.

Section \ref{sec:Theory} gives an brief theoretical background, with section \ref{sec:Data} describing our data collection and pre-processing. We then turn to initial analysis of the collected data in \ref{sec:Initial analysis}, after which we take a short detour to examine the limits of our methodology in section \ref{sec:Limits}.

%%%
\section{Theoretical Background}
\label{sec:Theory}
We use seismic body wave analysis in order to investigate the velocity structure of the upper inner core. These waves elastic waves, caused by earthquakes, that travel through the interior of the Earth.

\subsection{Body Wave Theory}
Here we summarise the main aspects of seismic body wave theory, taken from \cite{Shearer2009}.

Under the assumptions of a continuous, linearly elastic medium, infinitesimal strains and constant medium properties one can derive the elastic wave equation
\begin{equation}
	\rho \frac{\partial^{2} \vec{u}}{\partial t^{2}} = \left ( \lambda + \mu \right ) \nabla \left ( \nabla \cdot \vec{u} \right ) + \mu \nabla^{2} \vec{u}
	\label{eq:Wave Equation}
\end{equation}
where u is the local displacement vector, $\rho$ the density of the medium and $\lambda$ and $\mu$  Lam\'{e} parameters of the medium. A general displacement vector can be decomposed into irrotational scalar and solenoidal vector potentials such that
\begin{equation}
	u \equiv \nabla \phi + \nabla \times \vec{\psi}
	\label{eq:Displacement}
\end{equation}
Substituting \eqref{eq:Displacement} in to \eqref{eq:Wave Equation} yields two independent wave equations, one for $\phi$ and one for $\vec{\psi}$, which describe P-waves and S-waves respectively. P-waves are compressional with displacements occurring parallel to the wave vector, whereas S-waves are transverse with displacements occurring perpendicular to the wave vector. These wave equations take the form
\begin{equation}
	\frac{\partial^{2} \phi}{\partial t^{2}} = c^{2} \left ( \vec{x} \right ) \nabla^{2} \phi
\end{equation}
where $c(\vec{x})$ is the local wave velocity that depends on position. A velocity model is a full specification of $c(\vec{x})$ in the region of interest.

\subsection{Sampling the Inner Core}
\label{sec:Sampling}
Because the outer core is liquid with $\mu \approx 0$ and thus does not transmit S-waves, it is P-waves that are used to sample the inner core. Figure PUT FIGURE HERE shows the ray path for the PKiKP and PKIKP phase; they travel almost identical paths through the Crust, Mantle and upper Outer Core, after which PKiKP reflects off the Inner Core boundary, whereas PKIKP travels just underneath the boundary in the Inner Core.

All measurements are compared to the radially symmetric global velocity model from \cite{Kennett1995b} (hereafter called AK135), from which we seek to measure perturbations about. The residual travel time CHECK ME is defined after \cite{Waszek2011a} as
\begin{equation}
	\delta t = \left ( t_{PKiKP} - t_{PKIKP} \right )_{observed} -  \left ( t_{PKiKP} - t_{PKIKP} \right )_{model}
	\label{eq:Residual definition}
\end{equation}
This equation can be reformulated as an integral along the ray paths
\begin{equation}
		\delta t = \left (  \int \frac{1}{v_{obs}} - \frac{1}{v_{model}} ds  \right )_{PKiKP} - \left (  \int \frac{1}{v_{obs}} - \frac{1}{v_{model}} ds \right )_{PKIKP}
		\label{eq:deltat}
\end{equation}
where the path to be integrated along is indicated by the subscript outside the brackets, and in general the velocities vary as a function of position.

As the inner core has a very low viscosity (eg. \cite{Wijs1998}, \cite{Zhang2000}) we assume that it is unable to sustain any long term non-radial variations in velocity structure. Under this assumption $v_{jobs} = v_{model}$ for the outer core, setting the first integral in \eqref{eq:deltat} to zero.

Taking perturbations about the model of the form $v_{obs} = v_{model} + \delta v$ gives
\begin{equation}
	\delta t =\left ( \int \frac{\delta v}{v_{model} + \delta v }\frac{1}{v_{model}} ds \right )_{PKIKP}
\end{equation}
For depths below the Inner Core boundary of less than 50km $v_{model}$ is constant for AK135, and we assume $\delta v$ is also a constant such that we are measuring only the average velocity perturbation along the ray path. We are thus left with the equation (to first order in $\delta t$) that will allow us to compute $\delta v$
\begin{equation}
	\delta v = \frac{\delta t}{t} v_{model}
	\label{eq:Delta v}
\end{equation}
where $t$ is the time PKIKP spends in the inner core. A positive residual implies a positive velocity perturbation and vice versa, as expected from equation \eqref{eq:Residual definition}.

If instead we wish to construct a layered model, we simply apply the above results to the uppermost layer, and then take the effect of the new layer into account when calculating the properties of subsequent lower layers.

%%%
\section{Data Selection}
\label{sec:Data}
As discussed in section \ref{sec:Sampling}, we make differential travel time measurements of PKiKP and PKIKP phases. An ideal seismogram would have a clear PKIKP arrival, little noise and no interference from surface reflection phases. As such, individual events are selected to meet the following criteria:

\begin{itemize}
	\item Epicentral distance of $115^{\circ}$ - $143^{\circ}$ covers the majority of North America, where there is the highest worldwide density of seismometers.
	\item  Depth greater than 15km, to minimise possible interference between PKIKP (PKiKP) and pPKIKP (pPKiKP) phases\footnote{The preceding 'p' denotes a reflection from the Earth's surface.}.
	\item Magnitude greater than 5.2 and less than 6.3 to ensure a large enough earthquake to produce an observable signal, whilst a small enough earthquake such that the rupture is likely to be impulsive.
	\item A fracture mechanism that is primarily dip slip\footnote{This means a large component of motion is in the vertical direction}. As the ray paths are themselves nearly vertical when they reach the seismic stations (see PUT RAYPATH FIGURE HERE), a significant amount of energy is required to be focused in the vertical direction at the site of the earthquake.
\end{itemize}

Individual earthquakes meeting this criteria typically contain 100 to 600 individual seismograms. Each seismogram is filtered between 0.7Hz - 2Hz in order to focus on the expected frequency of $\sim$1Hz whilst removing unwanted noise at other frequencies. Individual seismograms are then checked by hand, and only those showing a clear PKIKP signal near the predicted arrival time are kept for further analysis. Event parameters are looked up using the Central Moment Tensor (CMT) Catalogue (\cite{Dziewonski1981}, \cite{Ekstrom2012}).

%%%%
\section{Initial data analysis}
\label{sec:Initial analysis}
The same analysis was performed on each individual event. Each event is listed in table \ref{tab:Events}.
\begin{table}\footnotesize
\centering
\begin{tabular}{| l | r | r | c | c | c | c |}
	\hline Location				& Latitude	& Longitude	& Date		& Time		& Magnitude	& Depth (km) 	\\ \hline
	\hline South Sandwich Islands	& -60.13	& -25.38		& 2005/08/04	& 12:11:22	& 5.4			& 34.0		\\
	\hline Mozambique			& -21.27	& 33.57		& 2006/04/14	& 18:41:39	& 5.2			& 30.4		\\
	\hline Uganda				& 1.72	& 30.65		& 2007/02/19	& 02:33:46	& 5.6			& 28.5		\\
	\hline South Sandwich Islands	& -60.04	& -27.46		& 2008/07/30	& 20:15:16	& 5.5			& 145.1		\\
	\hline Tanzania				& -9.50	& 39.22		& 2010/08/03	& 19:42:18	& 5.3			& 32.8		\\
	\hline Banda Sea			& -7.24	& 129.83		& 2013/08/12	& 00:53:45	& 6.1			& 105.2		\\
	\hline Owen Fracture Zone	& 11.35	& 57.43		& 2013/10/02	& 01:06:40	& 5.8			& 19.8		\\
	\hline Celebes Sea			& 4.55	& 122.82		& 2014/04/16	& 04:28:20	& 5.8			& 575.0  		\\ 
	\hline South Sandwich Islands 	& -60.01	& -26.76		& 2014/12/28	& 20:30:58	& 5.2			& 124.4		\\
	\hline	
\end{tabular}
\caption{Event details taken directly from the CMT Catalogue. Dates are formatted as year/month/day format and times as hour:minute:second}
\label{tab:Events}
\end{table}
Here we describe the analysis using data from the Celebes Sea event.

Synthetic waveforms are computed using the WKBJ ray tracing program (\cite{Chapman1976}) combined with rupture mechanisms from the CMT catalogue\footnote{See appendix \ref{app:Software} for full details of software used in our analysis.}. Predicted ray paths and individual ray travel times are computed using the TauP toolkit (\cite{Crotwell1999}). Initial plots are shown for both real and synthetic data in figures \ref{fig:Real nonaligned} and \ref{fig:Synth nonaligned} respectively, with zero time occurring at the time of the earthquake, taken from the global CMT catalogue. Overplotted are theoretical PKIKP and PKiKP travel times computed using the AK135 model (\cite{Kennett1995b}). The predicted travel times agree well with the data in both cases.  For shorter epicentral distances the predicted arrival times become closer, suggesting that eventually there will be a phase separation below which the two distinct phases will not be individually observable.

CHANGE THESE FIGURES
\begin{figure}
	\centering
	\includegraphics[width=0.6\textwidth]{figures/celebessea/celebessea_real.pdf}
	\caption{Real seismogram data from the Celebes Sea event after event selection. Each seismogram is zeroed on the earthquake time. Over plotted lines are theoretical phase arrivals computed using the AK135 model. Only data with a clear PKIKP arrival are plotted}
	\label{fig:Real nonaligned}
\end{figure}

\begin{figure}
	\centering
	\includegraphics[width=0.6\textwidth]{figures/celebessea/celebessea_synthetic_both.pdf}
	\caption{Synthetic seismogram data for the Celebes Sea event.. Each seismogram is zeroed on the earthquake time. Over plotted lines show theoretical phase arrivals computed using the AK135 model.}
	\label{fig:Synth nonaligned}
\end{figure}

In order to more easily visualise the two phases we plot seismograms with individual PKiKP and PKIKP phases. In conjunction we also plot synthetic seismograms with both phases present, called `combined' seismograms from now on. This seismogram simulates the real world where both phases are present.

Each of these is shifted such that the initial PKIKP downswing occurs at zero time. This is shown in figure \ref{fig:Synth aligned}. It is now clear to see the PKiKP phase merging with the PKIKP phase at low epicentral distances in the combined seismogram. We are now in a position to take residual measurements. Before we do this, we first examine the limits of PKIKP-PKiKP travel time analysis.

\begin{figure}
	\centering
	\includegraphics[width=0.4\textwidth]{figures/celebessea/celebessea_KIK_aligned}
	\includegraphics[width=0.4\textwidth]{figures/celebessea/celebessea_pkikp_aligned}
	\includegraphics[width=0.4\textwidth]{figures/celebessea/celebessea_both_aligned}
	\caption{Separated PKIKP (top left) PKiKP (top right), and combined (bottom) synthetic seismograms for the Celebes Sea event.}
	\label{fig:Synth aligned}
\end{figure}

%%%%
\section{The limits of PKiKP-PKIKP travel time analysis}
\label{sec:Limits}

In this section we seek to quantitively measure the limits of PKiKP-PKIKP travel time analysis when used to measure the velocity structure at the top of the inner core. Previous studies have only measured up to epicentral distances where PKiKP and PKIKP are distinct phases; in this study we attempt to study much lower epicentral distances. As such it will be useful to know at what distances we can make reliable PKiKP-PKIKP measurements using synthetic data which mimics real world data.

Because we do not know a-priori the actual velocity structure being measured, we perform analysis on the three distinct velocity models shown in figure \ref{fig:Velocity models}. Our two new models represent realistic East Hemisphere (EH) and West Hemisphere (WH) isotropic velocity models based on \cite{Waszek2011a}. In each case models are identical to AK135, with the velocity jump at the ICB is modified from 11.0427 km/s to 11.0 km/s (EH) and 11.1 km/s (WH).

\begin{figure}
	\centering
	\includegraphics[width=0.5\textwidth]{figures/velocity_models}
	\caption{Velocity models modified from AK135 (yellow line). Velocity at the ICB is varied at 11.1 km/s for a Western Hemisphere (WH) model (red line) and at 11.0 km/s for an Eastern Hemisphere (EH) model (blue line). The models outside the plotted region are identical to AK135.}
	\label{fig:Velocity models}
\end{figure}

\subsection{Minimum resolvable depth}
The only two features that are measurable at all distances in combined seismograms are the initial downswing and the final downswing (see figure \ref{fig:Synth aligned} bottom). When making measurements of real data we want to be sure that we are measuring a PKIKP feature (initial upswing) and PKiKP feature (final upswing), and not two PKiKP features. Measuring two PKiKP features is more likely at lower epicentral distances due to the PKIKP amplitude decreasing, and PKiKP developing a large upswing to the left. We note that distinguishing the two is not a problem for synthetic data, where we can take measurements from individual PKIKP and PKiKP seismograms separately.

To quantify where measurements on the combined seismogram become inaccurate, we plot the difference between PKIKP initial downswings (top left, figure \ref{fig:Synth aligned}) and combined initial downswing (bottom, figure \ref{fig:Synth aligned}). On the same figure we also plot the difference between PKiKP initial downswings and PKIKP initial downswings. This data is shown in figure \ref{fig:Downswing differences}. A three point moving average is applied in order to smooth the data; this does not significantly change the distribution of data. A depths below 8km PKiKP and combined measurements coincide, showing that in these cases the final downswing is actually a PKiKP feature, not a PKIKP as we want.

\begin{figure}
	\centering
	\includegraphics[width=0.7\textwidth]{figures/downswing_differences}
	\caption{Initial downswing measurements for PKiKP and combined synthetic seismograms computed from AK135. Measurements are taken relative to initial PKIKP downswings.}
	\label{fig:Downswing differences}
\end{figure}

In figure \ref{fig:Downswing models} we show the same as the combined measurements in figure \ref{fig:Downswing differences} for each velocity model.\footnote{AK135, EH and WH} Each curve is similar but offset from the other curves. Because we do not know the velocity structure we are measuring beforehand, we take deepest point at which the measurements tail off to large positive values as a cutoff for depths below which this method cannot be used. This occurs for the WH model (yellow points in figure \ref{fig:Downswing models}), at at a depth of 10km.

\begin{figure}
	\centering
	\includegraphics[width=0.7\textwidth]{figures/downswing_models}
	\caption{hello/}
	\label{fig:Downswing models}
\end{figure}

%%%
\subsection{Velocity perturbation calculation errors}
The end goal of this study is to calculate velocity structure perturbations using equation \eqref{eq:Delta v}. The error in an individual velocity perturbation calculated using equation \eqref{eq:Delta v} is
\begin{equation}
	\Delta \delta v = v_{model} \left ( \frac{\Delta \delta t}{t} - \Delta t \frac{\delta t}{t^{2}} \right )
	\label{eq:Velocity error}
\end{equation}
where we have taken into account possible error in the inner core travel time, $\Delta t$.

To estimate $t$ and $\Delta t$ we investigate how $t$ varies as a function and bottoming depth below the ICB, and how this variation depends on the velocity structure. This is shown in figure \ref{fig:Time in core}, with data taken from the Banda Sea event.\footnote{Although only data for an earthquake source depth of $\sim$100km is shown, we have plotted similar data for source depths in the range 30km - 575km and confirm that the data does not change with a varying source depth.} As a check of our modelling, we see that as bottoming depth $\rightarrow 0$, $t \rightarrow 0$, and at shallower depths the travel times for different models converge. 

Reading directly from figure \ref{fig:Time in core} at a depth of 10km, estimates are $t = 27.5s$ and $\Delta t = 2.5s$. A worst case residual is taken as $\delta t = 1.2s$. This allows us to estimate the worst-case magnitude of the second term in equation \eqref{eq:Velocity error} as $\sim 0.004$. This error is systematic and inherent in the methodology being used.

\begin{figure}
	\centering
	\includegraphics[width=0.5\textwidth]{figures/time_in_core}
	\caption{Time PKIKP spends in the inner core as a function of bottoming depth of the ray.}
	\label{fig:Time in core}
\end{figure}

To estimate the first timer of equation \eqref{eq:Velocity error} we take into account two possible sources of error. The first is the error in taking measurements from both real and synthetic seismograms that lead to a $\delta t$ measurement. To measure $\delta t$ two picks are made each on real (synthetic) seismograms which have a sample every 0.2s (0.1s). We attribute an error of 0.1s (0.05s) to one measurement, and hence an error of 0.16s to a $\delta t$ measurement. This corresponds to $\Delta \delta t = 0.0061$ This is a random error which could in theory be reduced to arbitrarily small values by increasing both the synthetic and real sampling rates.

The second source of error is the systematic mis-measurement of the PKIKP phase on a combined seismogram, shown in figure \ref{fig:Downswing differences}. Above the depths which we have excluded for analysis in the previous section, systematic errors are typically of the order $\sim 0.05s$ giving $\Delta \delta t = 0.0018$ Although this is much smaller than random error in this study, this error is again inherit in the methodology.

\begin{table}
\centering
\begin{tabular}{| c | c | c |}
	\hline
	 		& $\frac{\Delta \delta t}{t}$	& $\Delta t \frac{\delta t}{t^{2}}$	\\ \hline
	Our Study	& 0.0064				& 0.004	 				\\\hline
	Best case	& 0.0018				& 0.004					\\
	\hline
\end{tabular}
\caption{Event details taken directly from the CMT Catalogue. Dates are formatted as year/month/day format and times as hour:minute:second}
\end{table}

%%%%
\section{Residual Measurements}

In light of the analysis in the previous section, we now resume where we left off in section \ref{sec:Initial analysis} by making residual measurements. As before we proceed using the Banda Sea earthquake as an example, and present results for all earthquakes at the end.\footnote{See table \ref{tab:Events} for a full event listing and details}

Real seismograms aligned using the same method used for aligning synthetics (see figure \ref{fig:Synth aligned}) are shown in figure \ref{fig:Bandasea real aligned}. Peak to peak measurements taken on both the real and synthetic data are shown in figure \ref{fig:Bandasea residuals}. In this figure we plot residual measurements below 10km to illustrate how the real data tapers off, as in our previous analysis on synthetic data. From now on we only present data take at depths greater than 10km.

\begin{figure}
	\centering
	\includegraphics[width=0.6\textwidth]{figures/bandasea/bandasea_real_aligned}
	\caption{Aligned real measurements for the Banda Sea event.}
	\label{fig:Bandasea real aligned}
\end{figure}

\begin{figure}
	\centering
	\includegraphics[width=0.9\textwidth]{figures/bandasea/bandasea_resid}
	\caption{Left hand figure shows individual peak to peak measurements taken for both real data (orange crosses) and synthetic data (blue crosses). Right hand figure shows residuals calculated from the peak to peak measurements.}
	\label{fig:Bandasea residuals}
\end{figure}

%%%%
\appendix
\section{Software details}
\label{app:Software}
The following lists the software used in this paper along with brief descriptions of what each piece of software was used for.
\begin{itemize}
	\item IRIS Wilber
	\begin{itemize}
		\item Used to select events and download worldwide seismic data from each selected event.
	\end{itemize}
	\item Centroid Moment Tensor (CMT) Catalogue
	\begin{itemize}
		\item Used to set earthquake time and location, and to feed WKBJ with resolved moment tensors on an event by event basis.
	\end{itemize}
	\item Matlab 2015a (8.5.0.197613, maci64)
	\begin{itemize}
		\item Used to plot data.
	\end{itemize}
\end{itemize}

%%%%
\newpage
% Bibliography
\bibliographystyle{agu}
\bibliography{/Users/dstansby/Physics/Papers/library}

\end{document}